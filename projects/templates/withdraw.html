{% extends 'base.html' %}
{% load static %}

{% block content %}
<style>
    :root {
        --neon-blue: #00f3ff;
        --neon-pink: #bc13fe;
        --glass-bg: rgba(255, 255, 255, 0.05);
    }

    /* Karta Dizayni */
    .credit-card {
        background: linear-gradient(135deg, rgba(255,255,255,0.1), rgba(255,255,255,0));
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border-radius: 20px;
        border: 1px solid rgba(255,255,255,0.18);
        box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        height: 220px;
        width: 100%;
        max-width: 380px;
        margin: 0 auto;
        position: relative;
        overflow: hidden;
        transition: transform 0.3s;
    }
    .credit-card:hover { transform: translateY(-5px); }

    .card-shine {
        position: absolute; top: 0; left: 0; right: 0; bottom: 0;
        background: linear-gradient(135deg, rgba(255,255,255,0) 0%, rgba(255,255,255,0.1) 50%, rgba(255,255,255,0) 100%);
        transform: skewX(-20deg) translateX(-150%);
        animation: shine 6s infinite;
    }
    @keyframes shine {
        0% { transform: skewX(-20deg) translateX(-150%); }
        20% { transform: skewX(-20deg) translateX(150%); }
        100% { transform: skewX(-20deg) translateX(150%); }
    }

    .balance-text {
        font-size: 2.5rem;
        font-weight: 800;
        background: linear-gradient(to right, #fff, #a5b4fc);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        text-shadow: 0 0 20px rgba(99, 102, 241, 0.5);
    }

    /* Forma Elementlari */
    .withdraw-input {
        background: rgba(15, 23, 42, 0.6);
        border: 1px solid rgba(255, 255, 255, 0.1);
        color: #fff;
        border-radius: 12px;
        padding: 15px;
        font-size: 16px;
        transition: all 0.3s;
    }
    .withdraw-input:focus {
        background: rgba(15, 23, 42, 0.8);
        border-color: var(--neon-blue);
        box-shadow: 0 0 15px rgba(0, 243, 255, 0.2);
        outline: none;
    }

    .btn-withdraw {
        background: linear-gradient(45deg, #4f46e5, #bc13fe);
        border: none;
        color: white;
        padding: 15px;
        border-radius: 12px;
        font-weight: 700;
        letter-spacing: 1px;
        transition: all 0.3s;
        text-transform: uppercase;
    }
    .btn-withdraw:hover {
        transform: scale(1.02);
        box-shadow: 0 0 20px rgba(188, 19, 254, 0.4);
    }
</style>

<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-md-6 col-lg-5">

            <div class="credit-card p-4 mb-4 d-flex flex-column justify-content-between">
                <div class="card-shine"></div>
                <div class="d-flex justify-content-between align-items-start z-1">
                    <i class="fas fa-wallet fa-2x text-white opacity-75"></i>
                    <span class="badge bg-white bg-opacity-10 backdrop-blur border border-white border-opacity-25">Virtual Hamyon</span>
                </div>

                <div class="text-center z-1">
                    <span class="d-block text-white opacity-75 small text-uppercase ls-2 mb-1">Joriy Balans</span>
                    <h1 class="balance-text">${{ user.profile.balance }}</h1>
                </div>

                <div class="d-flex justify-content-between align-items-end z-1">
                    <div class="text-white opacity-75 small">
                        Egasi:<br>
                        <span class="fw-bold text-white ls-1">{{ user.username|upper }}</span>
                    </div>
                    <i class="fab fa-cc-visa fa-2x text-white opacity-50"></i>
                </div>
            </div>

            <div class="p-4 rounded-4 border border-secondary border-opacity-25" style="background: rgba(22, 27, 34, 0.8); backdrop-filter: blur(10px);">
                <h4 class="text-white fw-bold mb-4"><i class="fas fa-money-bill-wave text-success me-2"></i>Mablag'ni Yechish</h4>

                <form method="post">
                    {% csrf_token %}

                    <div class="mb-3">
                        <label class="text-light opacity-75 small mb-2">Karta Raqami (Uzcard/Humo/Visa)</label>
                        <div class="input-group">
                            <span class="input-group-text bg-dark border-secondary text-secondary"><i class="far fa-credit-card"></i></span>
                            <input type="text" name="card_number" class="form-control withdraw-input" placeholder="0000 0000 0000 0000" maxlength="16" required>
                        </div>
                    </div>

                    <div class="mb-4">
                        <label class="text-light opacity-75 small mb-2">Summa ($)</label>
                        <div class="input-group">
                            <span class="input-group-text bg-dark border-secondary text-success fw-bold">$</span>
                            <input type="number" name="amount" class="form-control withdraw-input" placeholder="Min: $5" min="5" step="0.01" required>
                        </div>
                        <div class="d-flex justify-content-between mt-2">
                            <small class="text-muted">Minimal yechish: $5</small>
                            <small class="text-info cursor-pointer" onclick="setMaxAmount()">Barchasini yechish</small>
                        </div>
                    </div>

                    <button type="submit" class="btn btn-withdraw w-100">
                        So'rov Yuborish <i class="fas fa-arrow-right ms-2"></i>
                    </button>
                </form>
            </div>

            <div class="mt-4 text-center">
                <p class="text-muted small">
                    <i class="fas fa-info-circle me-1"></i> So'rovlar odatda 24 soat ichida ko'rib chiqiladi. <br>
                    Xavfsizlik uchun barcha tranzaksiyalar admin tomonidan tasdiqlanadi.
                </p>
            </div>

        </div>
    </div>
</div>

<script>
    function setMaxAmount() {
        // Balansni olish va inputga qo'yish
        const balance = "{{ user.profile.balance }}".replace(',', '.');
        document.querySelector('input[name="amount"]').value = balance;
    }
</script>
{% endblock %}