{% for msg in chat_messages %}
    <div class="d-flex gap-3 mb-4 {% if msg.user == request.user %}justify-content-end text-end{% endif %}">
        {% if msg.user != request.user %}
            <img src="{% if msg.user.profile.avatar %}{{ msg.user.profile.avatar.url }}{% else %}https://ui-avatars.com/api/?name={{ msg.user.username }}{% endif %}" class="rounded-circle" width="35" height="35" style="object-fit: cover;">
        {% endif %}
        <div style="max-width: 75%;">
            <div class="small text-muted mb-1">@{{ msg.user.username }}</div>
            <div class="p-2 px-3 rounded-4 shadow-sm" style="background: {% if msg.user == request.user %}linear-gradient(135deg, var(--neon-primary), var(--neon-secondary)){% else %}rgba(255,255,255,0.05){% endif %}; border: 1px solid rgba(255,255,255,0.1); color: white;">
                {{ msg.body }}
            </div>
        </div>
    </div>
{% endfor %}